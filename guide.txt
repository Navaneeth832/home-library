# Step-by-step Guide to Deploying Your FastAPI Project on Render

This guide will walk you through deploying your FastAPI application, which uses a PostgreSQL database and Google Sheets API, to Render.

## Step 1: Push Your Code to a Git Repository

Render deploys applications from a Git repository (GitHub, GitLab, or Bitbucket).

1.  **Initialize a Git repository** in your project folder if you haven't already:
    ```bash
    git init
    ```
2.  **Create a `.gitignore` file** to exclude unnecessary files. Make sure it includes `credentials.json` and any `__pycache__` directories. Your existing `.gitignore` should be sufficient.
3.  **Add, commit, and push your code** to a new repository on your chosen platform (e.g., GitHub).

## Step 2: Set Up a PostgreSQL Database on Render

1.  Go to your Render Dashboard.
2.  Click **New +** and select **PostgreSQL**.
3.  Give your database a unique name and choose a region.
4.  Click **Create Database**.
5.  Once the database is created, find the **Connections** section and copy the **Internal Connection URL**. You will use this for your environment variables.

## Step 3: Create a New Web Service on Render

1.  On the Render Dashboard, click **New +** and select **Web Service**.
2.  Connect your Git repository.
3.  Configure the following settings:
    *   **Name:** Give your service a name (e.g., `home-library-app`).
    *   **Region:** Choose the same region as your database.
    *   **Branch:** Select the branch you want to deploy (e.g., `main`).
    *   **Root Directory:** Leave this as is unless your app is in a subdirectory.
    *   **Runtime:** Select **Python 3**.
    *   **Build Command:** `pip install -r requirements.txt`
    *   **Start Command:** `uvicorn main:app --host 0.0.0.0 --port $PORT`

## Step 4: Configure Environment Variables

You need to set up environment variables for your database connection and Google API credentials.

1.  In your Web Service settings, go to the **Environment** tab.
2.  Click **Add Environment Variable** for each of the following, using the values from your Render PostgreSQL database:
    *   `DB_HOST`: The hostname of your Render PostgreSQL database.
    *   `DB_NAME`: The database name.
    *   `DB_USER`: The username.
    *   `DB_PASS`: The password.

    **Note:** You can find these details in the **Connections** section of your PostgreSQL database on Render.

3.  **Handling `credentials.json`:** The `credentials.json` file should not be committed to your Git repository for security reasons. You have two main options:

    *   **Option A (Recommended): Use a Secret File**
        1.  In your Web Service settings, under the **Environment** tab, click **Add Secret File**.
        2.  For the **Filename**, enter `credentials.json`.
        3.  For the **Contents**, paste the entire content of your local `credentials.json` file.
        4.  Click **Create Secret File**.

    *   **Option B: Use Environment Variables for Google Credentials**
        If you prefer to store the credentials entirely in environment variables, you would need to modify your `main.py` to load the credentials from environment variables instead of a file. This is a more secure practice but requires code changes.

## Step 5: Deploy

1.  After configuring the environment variables and build/start commands, scroll down and click **Create Web Service**.
2.  Render will automatically start the build and deployment process. You can monitor the logs in the **Events** tab.
3.  Once the deployment is successful, your application will be available at the URL provided by Render.

## Summary of Render Configuration:

*   **Service Type:** Web Service
*   **Runtime:** Python 3
*   **Build Command:** `pip install -r requirements.txt`
*   **Start Command:** `uvicorn main:app --host 0.0.0.0 --port $PORT`
*   **Environment Variables:** `DB_HOST`, `DB_NAME`, `DB_USER`, `DB_PASS`
*   **Secret File:** `credentials.json` with your Google API credentials.

That's it! Your Home Library application should now be deployed and running on Render.
